/*!2017-10-30 18:24:28 merge: js/recipe/index.js,js/recipe/category.js!*/
;(function($){var flag=false,now=0,next=1,$bli=$("#index_big_img > li"),$sli=$("#index_small_img > li"),len=$bli.size(),timer='',timeout='';var rollback={init:function(){rollback.fast();$('.slideRoll').addClass('finish');timer=setInterval(rollback.run,6000);$sli.hover(function(){var _index=parseInt($(this).index());now=_index;next=((_index+1)>=len)?0:_index;timeout=setTimeout(rollback.fast,200);clearInterval(timer)},function(){timer=setInterval(rollback.run,6000);clearTimeout(timeout)});flag=true},fast:function(){flag?$bli.stop(true,true).eq(now).fadeIn(1500).siblings().fadeOut(1500):$bli.eq(now).show().siblings().hide();$sli.find("i").show().eq(now).hide()},run:function(){now=next;$bli.eq(now).fadeIn(1500).siblings().fadeOut(1500);$sli.find("i").show().eq(now).hide();var n=parseInt(next)+1;next=(n>=len)?0:n}};var active_user_cache={};var recipeindex={showcollect:function(){var now_page=min_page=1;var max_page=3;$("#recomment_collect_prev").click(function(){if(now_page>1&&now_page<=3){$('#recommend_collect_1').animate({'margin-left':'-'+660*(now_page-2)+'px'},600);$('#recommend_collect_2').animate({'margin-left':'-'+660*(now_page-3)+'px'},600);now_page=now_page-1;$('#recomment_collect_page').html(now_page+"/"+max_page);if(now_page==min_page){$('#recomment_collect_prev').removeClass("hover_l")}else{$('#recomment_collect_next').addClass("hover_r")}}});$("#recomment_collect_next").click(function(){if(now_page>=1&&now_page<3){$('#recommend_collect_1').animate({'margin-left':'-'+660*now_page+'px'},600);$('#recommend_collect_2').animate({'margin-left':'-'+660*(now_page-1)+'px'},600);now_page=now_page+1;$('#recomment_collect_page').html(now_page+"/"+max_page);if(now_page==max_page){$('#recomment_collect_next').removeClass("hover_r")}else{$('#recomment_collect_prev').addClass("hover_l")}}})}};$(function(){rollback.init();recipeindex.showcollect();$('.recipe_cared').click(function(){var uid=parseInt($(this).attr('id'));if(uid){hd.follow(uid)}})})})(jQuery);(function($){var category_tpl='<li><a class="ht" href="LINK" target="_blank" title="TITLE">TITLE<em class="ico12">&nbsp;</em></a></li>';var category_more='<li><a class="last" href="/recipe/category" target="_blank" title="更多分类标签">更多分类标签</a></li>';var recipe={category_auto:function(){var show=$('#category_nav:visible').size();if(show<=0){recipe.category_one()}else{recipe.category_two()}},category_one:function(){$('#category').hover(function(){$('#category_a').show()},function(){$('#category_a').hide()});var one_flag=true;$('#category').mouseover(function(){if(one_flag==true){one_flag=false;$('#category_nav').html('<li><a class="ht" href="javascript:;">菜谱分类加载中...</li>');$.ajax({url:hd.base.root+'recipe/ajax?do=categorylist',dataType:'json',success:function(json){if(json.status){var data=json.info;var html="",list=data;$.each(list,function(i,n){var k=i+1;var tmp=category_tpl;tmp=tmp.replace(/LINK/g,"/recipe/all?ct="+i);tmp=tmp.replace(/TITLE/g,n);html+=tmp});html+=category_more;$('#category_nav').html(html)}else{one_flag=true}}})}})},category_two:function(){var li_now=$('#category_nav li a').index($('#category_nav li a.sel'));$('#category_nav li:not(#category_nav li:last())').click(function(){var li_temp_now=$(this).index();if($('#category_box_'+li_temp_now).size()>0){$('#category_box_'+li_temp_now).show();$('.classified_box:not(#category_box_'+li_temp_now+')').hide();li_now=li_temp_now;$(this).children('a').addClass('sel');$(this).siblings().children('a').removeClass('sel')}})},favorite:function(){var survery=$('<div class="addfavs" style="display:block;"><a href="javascript://" title="加入到收藏夹"></a></div>');var css={'position':'fixed','top':200,'right':'0px'};if($.browser.version=='6.0'){css.position='absolute';$(window).scroll(function(){survery.css({'top':$(document).scrollTop()+$(window).height()/2})})}survery.css(css);$("body").append(survery);$('.addfavs a').click(function(){var ctrl=(navigator.userAgent.toLowerCase()).indexOf('mac')!=-1?'Command/Cmd':'CTRL';var title=document.title;var url=document.location.href;url=(url.indexOf('?')==-1)?url+"?from=favorite":url+'&from=favorite';try{window.external.addFavorite(url,title)}catch(e){try{window.sidebar.addPanel(title,url,"")}catch(e){hd.dialog.alert('加入到收藏夹失败！您可以尝试通过快捷键'+ctrl+' + D 加入到收藏夹~')}}})},navfixed:function(){$('.status_space').hide();$('.new_status').addClass('lock');var flex="",nav_top=0,nav_class="fixed";var show=$('#category_nav:visible').size();var flex=$('.def_header');if(show==0){nav_top=113}else{nav_top=395}if(flex){$(window).bind('scroll.fixed',function(){if(!flex.data('fixed')&&$(document).scrollTop()>=nav_top){flex.addClass(nav_class).data('fixed',1);if(nav_top==395){recipe.change_cate_down(flex)}}else if($(document).scrollTop()<nav_top){flex.removeClass(nav_class).data('fixed',0);if(nav_top==395){recipe.change_cate_up(flex)}}});$(window).trigger("scroll")}},'change_cate_down':function(flex){flex.find('p.tt,p.xt').html('菜谱分类导航<i class="ico20 iarr">&nbsp;</i>');flex.find('#category_a').hide();flex.find('#category').hover(function(){flex.find('#category_a').show()},function(){flex.find('#category_a').hide()});var t=flex.find('#category_nav li').size();flex.find('#category_nav li').each(function(i,n){var k=parseInt(i+1);if(k<t){$(this).children('a').attr("href","/recipe/all?ct="+k)}})},'change_cate_up':function(flex){flex.find('p.tt,p.xt').html('菜谱分类导航');flex.find('#category_a').show();flex.find('#category').unbind("hover")}};$(function(){if(!hd.base.ie6){recipe.navfixed()}recipe.category_auto();recipe.favorite()})})(jQuery);